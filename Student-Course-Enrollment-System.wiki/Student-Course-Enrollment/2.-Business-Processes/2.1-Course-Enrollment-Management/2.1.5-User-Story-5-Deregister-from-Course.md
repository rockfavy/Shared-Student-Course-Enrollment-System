# User Story 5 — Deregister from a Course

---

## Use Case: Deregister from a Course

::: mermaid
sequenceDiagram
    participant Student
    participant Frontend as Blazor WASM
    participant API as Minimal API
    participant EnrollmentService
    participant DB as In-Memory DB

    Student->>Frontend: Click "Deregister" button
    Frontend->>Frontend: Show confirmation dialog
    Student->>Frontend: Confirm deregistration
    Frontend->>API: DELETE /enrollments/{enrollmentId}
    API->>EnrollmentService: DeleteEnrollmentAsync(enrollmentId, studentId)
    EnrollmentService->>DB: Verify enrollment ownership
    DB->>EnrollmentService: Ownership confirmed
    EnrollmentService->>DB: Delete enrollment record
    DB->>EnrollmentService: Return success
    EnrollmentService->>API: Return success
    API->>Frontend: Return confirmation
    Frontend->>Frontend: Refresh enrollments list
    Frontend->>Student: Show success message
:::

**User Story:** As a student, I want to deregister from a course so I can update my course load.

**Actors:** Student, System

**Description / Goal:**  
Student removes an enrollment by clicking "Deregister" on a course. System validates ownership and removes the enrollment record.

**Preconditions:** Student is authenticated and has an active enrollment for the course.

**Main Flow:**  
1. Student views enrolled courses  
2. Student selects course to deregister  
3. Student clicks "Deregister" button  
4. System shows confirmation dialog  
5. Student confirms deregistration  
6. System validates enrollment ownership  
7. System removes enrollment record from database  
8. System confirms deregistration  
9. System refreshes enrollment list  
10. Student sees updated enrollment list  

**Alternate Flows / Exceptions:**  
- Enrollment not found → system displays error message  
- Ownership mismatch → system returns 403 Forbidden  
- Student not authenticated → system redirects to login  
- Database error → system displays error message  

**Postconditions:**  
- Enrollment record removed  
- Student no longer enrolled in course  
- Enrollment list updated  

---

Detailed implementation tasks are documented in the [task catalogue](./2.1.5.1-Tasks-Deregister-from-Course.md).

---

