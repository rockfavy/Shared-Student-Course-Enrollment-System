# Student Course Enrollment System â€“ Frontend Testing Documentation
---

# 1. Overview

Frontend testing strategy using **bUnit** for Blazor component testing and **Playwright** for end-to-end testing. Covers:

- Blazor Components (tested with bUnit)  
- Models  
- Client-side validation  
- Component rendering  
- Form interactions  
- Layout consistency  
- End-to-end browser-based UI workflows  

---

# 2. Testing Layers

## 2.1 Unit Tests (Components + Models)
Frontend unit tests validate:

- Model validation attributes  
- Model mapping/transformation logic  
- Component logic (not rendering)  
- Client-side validation messages (where applicable)  

---

## 2.2 Component Tests (Blazor Component Rendering)

Component tests use **bUnit** to validate rendering and interactions. bUnit is the standard testing framework for Blazor components.

### Component Test Targets
- Component rendering  
- Parameter binding correctness  
- Event handling  
- State management  
- Required field indicators  
- Presence of expected controls and form fields

### bUnit Testing Approach

bUnit provides:
- Component rendering without a browser
- Markup verification
- Event triggering and verification
- Parameter and cascading parameter testing
- Service injection and mocking  

---

## 2.3 Integration Tests (API Communication)
Integration tests validate API communication.

### Integration Test Targets
- HTTP client behavior  
- API response handling  
- Error handling  
- Authentication token handling  

---

## 2.4 End-to-End (E2E) Browser Tests
E2E tests validate full UI workflows using browser automation tools.

### Tools
- **bUnit** - Primary tool for Blazor component testing (unit and component level)
- **Playwright** - For end-to-end browser-based testing  

### E2E Test Targets
- Page rendering correctness  
- Form interactions  
- Client-side validation  
- Button and link behavior  
- Navigation between screens  
- Real workflow simulation for enrollment modules  
- Authentication flows  

---

# 3. Required Test Scenarios

## 3.1 Authentication Scenarios (Frontend)

### UI Behavior
- Registration form renders all required fields  
- Required/optional fields correctly marked  
- Email field enforces format  
- Password field enforces strength requirements  
- Login form validates credentials  

### E2E Flows
- Submit full registration form  
- Invalid fields show validation messages  
- Duplicate email error visible  
- Login with valid credentials  
- Login with invalid credentials  
- Logout functionality  

---

## 3.2 Course Browsing Scenarios (Frontend)

### UI Behavior
- Courses list renders correctly  
- Course cards display all information  
- Search functionality works  
- Pagination works (if implemented)  

### E2E Flows
- Browse available courses  
- View course details  
- Search for courses  
- Navigate between courses  

---

## 3.3 Enrollment Scenarios (Frontend)

### UI Behavior
- Enroll button visible when authenticated  
- Enrollment status displayed correctly  
- Course capacity shown  
- Duplicate enrollment prevented in UI  

### E2E Flows
- Enroll in course  
- View enrollment confirmation  
- View my enrollments  
- Deregister from course  
- Confirmation messages displayed  

---

## 3.4 Enrollment Management Scenarios (Frontend)

### UI Behavior
- Enrollments list loads correctly  
- Only student's own enrollments displayed  
- Deregister button visible for enrolled courses  
- Empty state displayed when no enrollments  

### E2E Flows
- View enrolled courses  
- Deregister from course  
- Confirmation dialog works  
- List refreshes after deregistration  

---

# 4. Test Data Strategy

## Unit Tests
- Inline model data  
- No API calls  
- Mock HTTP clients  

## Component Tests
- Sample data for component rendering  
- Static deterministic data  
- Mock authentication state  

## Integration Tests
- Test API endpoints  
- Mock database responses  

## E2E Tests
- Synthetic students  
- Test courses  
- Test enrollments  
- No external dependencies  

---

# 5. CI/CD Integration

Frontend tests must execute in this order:

1. Build Blazor WASM  
2. Component compilation tests  
3. Unit tests  
4. Component tests  
5. Integration tests  
6. End-to-end browser tests  
7. Package and deploy  

---

# 6. Coverage Requirements

```
Component logic:               90%
Model validation:              100%
API client logic:              90%
E2E UI flows:                   Scenario-based
```

All critical screens and workflows must be covered by E2E tests, and all components must meet the minimum unit test coverage threshold.

---

# 7. Testing Tools

## 7.1 bUnit (Component Testing)

bUnit is the primary testing framework for Blazor components. It allows testing components in isolation without requiring a browser.

### Basic Component Test

```csharp
using bunit;
using Xunit;

public class CourseCardTests : TestContext
{
    [Fact]
    public void CourseCard_Renders_Correctly()
    {
        var course = new Course 
        { 
            Id = Guid.NewGuid(), 
            Name = "Test Course", 
            Description = "Description", 
            Capacity = 50 
        };
        
        var cut = RenderComponent<CourseCard>(parameters => parameters
            .Add(p => p.Course, course));
        
        cut.MarkupMatches("<h3>Test Course</h3>");
    }
}
```

### Component with Service Injection

```csharp
[Fact]
public void CoursesPage_Displays_Courses_From_Service()
{
    var mockCoursesClient = new Mock<ICoursesClient>();
    mockCoursesClient.Setup(x => x.GetCoursesAsync())
        .ReturnsAsync(new List<Course> { new Course { Name = "Test Course" } });
    
    Services.AddSingleton(mockCoursesClient.Object);
    
    var cut = RenderComponent<CoursesPage>();
    
    cut.WaitForState(() => cut.FindAll("li").Count > 0);
    Assert.Contains("Test Course", cut.Markup);
}
```

### Event Handling Test

```csharp
[Fact]
public void EnrollButton_Triggers_Enrollment()
{
    var cut = RenderComponent<CourseCard>();
    var enrollButton = cut.Find("button[type='submit']");
    
    enrollButton.Click();
    
    cut.WaitForAssertion(() => 
        Assert.Contains("Enrolled", cut.Markup));
}
```

## 7.2 Playwright (E2E Testing)

```csharp
[Fact]
public async Task Enroll_In_Course_Flow()
{
    await Page.GotoAsync("/courses");
    await Page.ClickAsync("text=Enroll");
    await Expect(Page.Locator("text=Enrollment successful")).ToBeVisibleAsync();
}
```

---

# 8. Mocking Strategies

## 8.1 HTTP Client Mocking

```csharp
var mockHttp = new MockHttpMessageHandler();
mockHttp.When("http://localhost/api/courses")
    .Respond("application/json", "[{\"id\":\"...\",\"name\":\"Test Course\"}]");

var httpClient = new HttpClient(mockHttp);
```

## 8.2 Authentication State Mocking

```csharp
var authState = new AuthenticationState(
    new ClaimsPrincipal(
        new ClaimsIdentity(new[] { new Claim(ClaimTypes.Name, "test@example.com") }, "test")));

var authStateProvider = new Mock<AuthenticationStateProvider>();
authStateProvider.Setup(x => x.GetAuthenticationStateAsync())
    .ReturnsAsync(authState);
```

---

