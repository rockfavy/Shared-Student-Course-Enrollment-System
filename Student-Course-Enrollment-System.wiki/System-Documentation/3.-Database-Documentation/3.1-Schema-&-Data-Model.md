# Student Course Enrollment System - Data Model & Schema Documentation
---
# 1. Overview

The data model consists of three core entities that support student authentication, course management, and enrollment tracking. The in-memory database stores enrollment data with clear entity relationships and consistent structure.

The schema supports:

- Student Authentication  
- Course Management  
- Enrollment Management  

Entity formats follow domain-driven modeling principles aligned with our API workflows.

---

# 2. Database Entities

The database consists of three core entities aligned with enrollment modules:

```text
Students        → Student accounts and authentication
Courses         → Available courses
Enrollments     → Student-course enrollment relationships
```

### Description of Entities

**Students** — Student identity, authentication, and personal information  
**Courses** — Course information and details  
**Enrollments** — Many-to-many relationship between students and courses  

Each entity uses a strongly defined structure enforced by EF Core and validated via the API layer.

---

# 3. Student Entity Structure

```csharp
public class Student
{
    public Guid Id { get; set; }
    public string Email { get; set; }
    public string PasswordHash { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime CreatedAt { get; set; }
    
    // Navigation property
    public ICollection<Enrollment> Enrollments { get; set; } = new List<Enrollment>();
}
```

### Purpose  
The **Student** entity is the authoritative system of record for student identity, authentication, and enrollment relationships.

### Key Fields
- `Id` → Unique identifier (Guid)
- `Email` → Unique email address (used for login)
- `PasswordHash` → Hashed password (never plain text)
- `FirstName` → Student's first name
- `LastName` → Student's last name
- `CreatedAt` → Account creation timestamp
- `Enrollments` → Collection of enrollment records

---

# 4. Course Entity Structure

```csharp
public class Course
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public int Capacity { get; set; } // Optional
    public DateTime CreatedAt { get; set; }
    
    // Navigation property
    public ICollection<Enrollment> Enrollments { get; set; } = new List<Enrollment>();
}
```

### Purpose  
Stores course information including name, description, and capacity.

### Key Fields
- `Id` → Unique identifier (Guid)
- `Name` → Course name
- `Description` → Course description
- `Capacity` → Maximum number of students (optional)
- `CreatedAt` → Course creation timestamp
- `Enrollments` → Collection of enrollment records

---

# 5. Enrollment Entity Structure

```csharp
public class Enrollment
{
    public Guid Id { get; set; }
    public Guid StudentId { get; set; }
    public Guid CourseId { get; set; }
    public DateTime EnrolledAt { get; set; }
    
    // Navigation properties
    public Student Student { get; set; }
    public Course Course { get; set; }
}
```

### Purpose  
Represents the many-to-many relationship between students and courses.

### Key Fields
- `Id` → Unique identifier (Guid)
- `StudentId` → Foreign key to Student
- `CourseId` → Foreign key to Course
- `EnrolledAt` → Enrollment timestamp
- `Student` → Navigation to Student entity
- `Course` → Navigation to Course entity

---

# 6. Entity Relationships

## 6.1 Student ↔ Enrollment (One-to-Many)

- A student can have multiple enrollments
- Each enrollment belongs to one student
- Relationship: `Student.Enrollments` → `Enrollment.Student`

## 6.2 Course ↔ Enrollment (One-to-Many)

- A course can have multiple enrollments
- Each enrollment belongs to one course
- Relationship: `Course.Enrollments` → `Enrollment.Course`

## 6.3 Many-to-Many Relationship

- Students and Courses have a many-to-many relationship through Enrollments

---

# 7. Database Context Configuration

```csharp
public class EnrollmentContext : DbContext
{
    public DbSet<Student> Students => Set<Student>();
    public DbSet<Course> Courses => Set<Course>();
    public DbSet<Enrollment> Enrollments => Set<Enrollment>();
    
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        // Configure Student
        modelBuilder.Entity<Student>(entity =>
        {
            entity.HasKey(e => e.Id);
            entity.HasIndex(e => e.Email).IsUnique();
            entity.Property(e => e.Email).IsRequired().HasMaxLength(255);
            entity.Property(e => e.PasswordHash).IsRequired();
            entity.Property(e => e.FirstName).IsRequired().HasMaxLength(100);
            entity.Property(e => e.LastName).IsRequired().HasMaxLength(100);
        });
        
        // Configure Course
        modelBuilder.Entity<Course>(entity =>
        {
            entity.HasKey(e => e.Id);
            entity.Property(e => e.Name).IsRequired().HasMaxLength(200);
            entity.Property(e => e.Description).HasMaxLength(1000);
            entity.Property(e => e.Capacity).HasDefaultValue(0);
        });
        
        // Configure Enrollment
        modelBuilder.Entity<Enrollment>(entity =>
        {
            entity.HasKey(e => e.Id);
            entity.HasIndex(e => new { e.StudentId, e.CourseId }).IsUnique();
            
            entity.HasOne(e => e.Student)
                .WithMany(s => s.Enrollments)
                .HasForeignKey(e => e.StudentId)
                .OnDelete(DeleteBehavior.Cascade);
                
            entity.HasOne(e => e.Course)
                .WithMany(c => c.Enrollments)
                .HasForeignKey(e => e.CourseId)
                .OnDelete(DeleteBehavior.Restrict);
        });
    }
}
```

---

# 8. Indexes and Constraints

## 8.1 Unique Constraints

- Student email must be unique
- Enrollment (StudentId, CourseId) combination must be unique

## 8.2 Required Fields

- Student: Email, PasswordHash, FirstName, LastName
- Course: Name, Description
- Enrollment: StudentId, CourseId, EnrolledAt

## 8.3 Foreign Key Constraints

- Enrollment.StudentId → Student.Id (Cascade delete)
- Enrollment.CourseId → Course.Id (Restrict delete)

---

# 9. Data Types

## 9.1 Identifiers

- All entities use `Guid` for primary keys
- Provides globally unique identifiers
- No sequential ID concerns

## 9.2 Strings

- Email: MaxLength(255)
- Names: MaxLength(100)
- Course Name: MaxLength(200)
- Description: MaxLength(1000)

## 9.3 Dates

- All timestamps use `DateTime` or `DateTimeOffset`
- Use UTC for consistency

---