# Enroll in a Course – Task Catalogue
---

## Task 1: Create API endpoint for enrolling a student in a course

**Description:**  
- **Front-End:** N/A  
- **Back-End:** Create `EnrollmentEndpoints.cs` with `MapEnrollmentEndpoints()` extension method. Implement `POST /enrollments` endpoint that accepts courseId. Validate student authentication and prevent duplicate enrollments.  
- **Database:** Create `Enrollment` entity with Id, StudentId, CourseId, EnrolledAt. Configure many-to-many relationship between Student and Course.  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class EnrollmentEndpoints {
        +MapEnrollmentEndpoints(WebApplication app)
        +EnrollEndpoint(HttpContext, Guid courseId, EnrollmentService) Task~IResult~
    }
    
    class EnrollmentService {
        +EnrollAsync(Guid studentId, Guid courseId) Task~EnrollmentResult~
        +CheckDuplicateEnrollment(Guid studentId, Guid courseId) Task~bool~
    }
    
    EnrollmentEndpoints --> EnrollmentService
    EnrollmentService --> EnrollmentContext
:::

### Entity Diagram

::: mermaid
erDiagram
    Enrollment {
        Guid Id PK
        Guid StudentId FK
        Guid CourseId FK
        DateTime EnrolledAt
    }
    
    Student ||--o{ Enrollment : has
    Course ||--o{ Enrollment : has
:::

---

## Task 2: Update in-memory DB relationship (many-to-many: student ↔ courses)

**Description:**  
- **Front-End:** N/A  
- **Back-End:** Configure `Enrollment` entity in `EnrollmentContext.OnModelCreating()`. Set up foreign keys to `Student` and `Course`. Add unique constraint on (StudentId, CourseId) to prevent duplicates.  
- **Database:** Configure many-to-many relationship through `Enrollment` join entity. Add navigation properties `Student.Enrollments` and `Course.Enrollments`.  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class EnrollmentContext {
        +DbSet~Student~ Students
        +DbSet~Course~ Courses
        +DbSet~Enrollment~ Enrollments
        +OnModelCreating(ModelBuilder)
    }
    
    class Student {
        +Guid Id
        +ICollection~Enrollment~ Enrollments
    }
    
    class Course {
        +Guid Id
        +ICollection~Enrollment~ Enrollments
    }
    
    class Enrollment {
        +Guid Id
        +Guid StudentId
        +Guid CourseId
        +Student Student
        +Course Course
    }
    
    EnrollmentContext --> Student
    EnrollmentContext --> Course
    EnrollmentContext --> Enrollment
    Student --> Enrollment
    Course --> Enrollment
:::

### Entity Diagram

::: mermaid
erDiagram
    Student ||--o{ Enrollment : "enrolls in"
    Course ||--o{ Enrollment : "has students"
    
    Student {
        Guid Id PK
        string Email UK
        string PasswordHash
        string FirstName
        string LastName
        DateTime CreatedAt
    }
    
    Course {
        Guid Id PK
        string Name
        string Description
        int Capacity
        DateTime CreatedAt
    }
    
    Enrollment {
        Guid Id PK
        Guid StudentId FK
        Guid CourseId FK
        DateTime EnrolledAt
    }
:::

---

## Task 3: Add "Enroll" button in the Blazor UI

**Description:**  
- **Front-End:** Add "Enroll" button to `CourseCard.razor` or `CoursesPage.razor`. Implement click handler that calls enrollment endpoint. Show loading state during enrollment.  
- **Back-End:** N/A  
- **Database:** N/A  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class CourseCard {
        +Course Course
        +EnrollAsync() Task
        +bool IsEnrolling
    }
    
    class EnrollmentsClient {
        +HttpClient httpClient
        +EnrollAsync(Guid courseId) Task~EnrollmentResult~
    }
    
    CourseCard --> EnrollmentsClient
:::

---

## Task 4: Integrate with authenticated user context

**Description:**  
- **Front-End:** Extract student ID from authentication token/claims. Pass student ID to enrollment endpoint. Ensure only authenticated users can enroll.  
- **Back-End:** Extract student ID from JWT claims in enrollment endpoint. Validate student exists.  
- **Database:** N/A  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class AuthenticationStateProvider {
        +GetAuthenticationStateAsync() Task~AuthenticationState~
    }
    
    class EnrollmentsClient {
        +HttpClient httpClient
        +EnrollAsync(Guid courseId) Task~EnrollmentResult~
    }
    
    class EnrollmentEndpoints {
        +EnrollEndpoint(HttpContext, Guid courseId) Task~IResult~
        +GetStudentIdFromClaims(HttpContext) Guid
    }
    
    EnrollmentsClient --> AuthenticationStateProvider
    EnrollmentEndpoints --> AuthenticationStateProvider
:::

---

## Task 5: Display confirmation message

**Description:**  
- **Front-End:** Show success message after enrollment completes. Display error message if enrollment fails. Use toast notification or inline message component.  
- **Back-End:** N/A  
- **Database:** N/A  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class CourseCard {
        +Course Course
        +EnrollAsync() Task
        +string SuccessMessage
        +string ErrorMessage
    }
    
    class ToastNotification {
        +ShowSuccess(string message)
        +ShowError(string message)
    }
    
    CourseCard --> ToastNotification
:::

---

## Task 6: Log enrollment in API (optional)

**Description:**  
- **Front-End:** N/A  
- **Back-End:** Add logging statement when enrollment is created. Log student ID, course ID, and timestamp. Use structured logging.  
- **Database:** N/A  
- **Infrastructure:** N/A

### Class Diagram

::: mermaid
classDiagram
    class EnrollmentService {
        +EnrollAsync(Guid studentId, Guid courseId) Task~EnrollmentResult~
        +ILogger Logger
    }
    
    EnrollmentService --> ILogger
:::

---




